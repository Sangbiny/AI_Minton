{% extends "base.html" %}

{% block title %}게임 매칭 만들기{% endblock %}

{% block content %}
    <form method="post" action="/match">
        <label for="total_game_count">총 게임 수:</label>
        <input type="text" id="total_game_count" name="total_game_count"><br><br>

        <div id="playerInputs">
            <div>
                <label>이름: <input type="text" name="name1"></label>
                <label>성별:
                    <select name="gender1">
                        <option value="M">남</option>
                        <option value="F">여</option>
                    </select>
                </label>
                <label>레벨:
                    <select name="level1">
                        <option value="A">A</option>
                        <option value="B">B</option>
                        <option value="C">C</option>
                        <option value="D">D</option>
                    </select>
                </label>
            </div>
        </div>

        <button type="button" onclick="addPlayer()">참가자 추가</button><br><br>
        <button type="submit">매칭 실행</button>
    </form>

    {% if result %}
        <h2>매칭 결과</h2>
        <pre>{{ result }}</pre>

        {% if game_counts %}
            <h3>멤버별 게임 수</h3>
            <ul>
                {% for name, count in game_counts.items() %}
                    <li>{{ name }}: {{ count }}게임</li>
                {% endfor %}
            </ul>
        {% endif %}
    {% endif %}

    <script>
        let playerIndex = 2;
        function addPlayer() {
            const container = document.getElementById("playerInputs");
            const div = document.createElement("div");
            div.innerHTML = `
                <label>이름: <input type="text" name="name${playerIndex}"></label>
                <label>성별:
                    <select name="gender${playerIndex}">
                        <option value="M">남</option>
                        <option value="F">여</option>
                    </select>
                </label>
                <label>레벨:
                    <select name="level${playerIndex}">
                        <option value="A">A</option>
                        <option value="B">B</option>
                        <option value="C">C</option>
                        <option value="D">D</option>
                    </select>
                </label>
            `;
            container.appendChild(div);
            playerIndex++;
        }
    </script>
{% endblock %}

